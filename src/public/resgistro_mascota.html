<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Mascotas</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>Gestión de Mascotas</h1>
        <button class="btn btn-primary" data-toggle="modal" data-target="#registroModal">Registrar Mascota</button>
        <button class="btn btn-secondary" data-toggle="modal" data-target="#actualizarModal">Actualizar Mascota</button>
        <button class="btn btn-info" data-toggle="modal" data-target="#buscarModal">Buscar Mascota</button>
        <button class="btn btn-danger" data-toggle="modal" data-target="#eliminarModal">Eliminar Mascota</button>
    </div>

    <!-- Modal de Registro -->
    <div class="modal fade" id="registroModal" tabindex="-1" role="dialog" aria-labelledby="registroModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="registroModalLabel">Registrar Mascota</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form id="registroMascotaForm">
                <input type="text" id="nombre" placeholder="Nombre" required>
                <input type="text" id="especie" placeholder="Especie" required>
                <input type="text" id="raza" placeholder="Raza">
                <input type="date" id="fechaNacimiento" placeholder="Fecha de Nacimiento">
                <input type="number" id="idCliente" placeholder="ID del Propietario" required>
                <button type="submit">Registrar Mascota</button>
              </form>
            </div>
          </div>
        </div>
      </div>

    <!-- Modal de Actualización -->
    <div class="modal fade" id="actualizarModal" tabindex="-1" role="dialog" aria-labelledby="actualizarModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="actualizarModalLabel">Actualizar Mascota</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="actualizarMascotaForm">
                        <input type="text" id="idMascotaActualizar" placeholder="ID de Mascota" class="form-control mb-2" required>
                        <input type="text" id="nombreActualizar" placeholder="Nombre" class="form-control mb-2" required>
                        <input type="text" id="especieActualizar" placeholder="Especie" class="form-control mb-2" required>
                        <input type="text" id="razaActualizar" placeholder="Raza" class="form-control mb-2" required>
                        <input type="date" id="fechaNacimientoActualizar" placeholder="Fecha de Nacimiento" class="form-control mb-2">
                        <input type="number" id="idClienteActualizar" placeholder="ID del Propietario" class="form-control mb-2" required>
                        <button type="submit" class="btn btn-secondary">Actualizar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Búsqueda -->
    <div class="modal fade" id="buscarModal" tabindex="-1" role="dialog" aria-labelledby="buscarModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="buscarModalLabel">Buscar Mascota</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="buscarMascotaForm">
                        <input type="text" id="idMascotaBuscar" placeholder="ID de Mascota" class="form-control mb-2" required>
                        <button type="submit" class="btn btn-info">Buscar</button>
                    </form>
                    <div id="resultBuscar" class="mt-3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Eliminación -->
    <div class="modal fade" id="eliminarModal" tabindex="-1" role="dialog" aria-labelledby="eliminarModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="eliminarModalLabel">Eliminar Mascota</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="eliminarMascotaForm">
                        <input type="text" id="idMascotaEliminar" placeholder="ID de Mascota" class="form-control mb-2" required>
                        <button type="submit" class="btn btn-danger">Eliminar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
        // Registro de Mascota
        document.getElementById('registroMascotaForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const nombre = document.getElementById('nombre').value;
            const especie = document.getElementById('especie').value;
            const raza = document.getElementById('raza').value;
            const fechaNacimiento = document.getElementById('fechaNacimiento').value;
            const idCliente = document.getElementById('idCliente').value;
            
            const response = await fetch('/api/mascotas', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nombre, especie, raza, fechaNacimiento, idCliente })
            });

            if (response.ok) {
                alert('Mascota registrada exitosamente');
                $('#registroModal').modal('hide');
                document.getElementById('registroMascotaForm').reset();
            } else {
                alert('Error al registrar la mascota');
            }
        });

        // Actualización de Mascota
        document.getElementById('actualizarMascotaForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const idMascota = document.getElementById('idMascotaActualizar').value;
            const nombre = document.getElementById('nombreActualizar').value;
            const especie = document.getElementById('especieActualizar').value;
            const raza = document.getElementById('razaActualizar').value;
            const fechaNacimiento = document.getElementById('fechaNacimientoActualizar').value;
            const idCliente = document.getElementById('idClienteActualizar').value;
            
            const response = await fetch(`/api/mascotas/${idMascota}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nombre, especie, raza, fechaNacimiento, idCliente })
            });

            if (response.ok) {
                alert('Mascota actualizada exitosamente');
                $('#actualizarModal').modal('hide');
                document.getElementById('actualizarMascotaForm').reset();
            } else {
                alert('Error al actualizar la mascota');
            }
        });

        // Búsqueda de Mascota
        document.getElementById('buscarMascotaForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const idMascota = document.getElementById('idMascotaBuscar').value;
            
            const response = await fetch(`/api/mascotas/${idMascota}`);
            
            if (response.ok) {
                const mascota = await response.json();
                document.getElementById('resultBuscar').textContent = `Nombre: ${mascota.nombre}, Especie: ${mascota.especie}, Raza: ${mascota.raza}, Fecha de Nacimiento: ${mascota.fechaNacimiento}, Propietario: ${mascota.propietario}`;
            } else {
                document.getElementById('resultBuscar').textContent = 'Mascota no encontrada';
            }
        });

        // Eliminación de Mascota
        document.getElementById('eliminarMascotaForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const idMascota = document.getElementById('idMascotaEliminar').value;
            
            const response = await fetch(`/api/mascotas/${idMascota}`, { method: 'DELETE' });
            
            if (response.ok) {
                alert('Mascota eliminada exitosamente');
                $('#eliminarModal').modal('hide');
                document.getElementById('eliminarMascotaForm').reset();
            } else {
                alert('Error al eliminar la mascota');
            }
        });

        // Registro de Mascota
document.getElementById('registroMascotaForm').addEventListener('submit', async function (event) {
  event.preventDefault();
  const nombre = document.getElementById('nombre').value;
  const edad = document.getElementById('edad').value;
  const raza = document.getElementById('raza').value;
  const idCliente = document.getElementById('idCliente').value;
  const estado = true; // O ajusta según necesites

  const response = await fetch('/api/mascotas', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ nombre, edad, raza, idCliente, estado }) // Incluye estado en el objeto JSON enviado
  });

  if (response.ok) {
    alert('Mascota registrada exitosamente');
    $('#registroModal').modal('hide');
    document.getElementById('registroMascotaForm').reset();
  } else {
    alert('Error al registrar la mascota');
  }
});


    </script>
</body>
</html>
