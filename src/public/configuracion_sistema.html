<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS v5.2.1 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="shortcut icon" href="./static/image/icon-header.svg" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./static/style/normalize.css" />
    <link rel="stylesheet" href="./static/style/reset.css" />
    <link rel="stylesheet" href="./static/style/base.css" />
    <link rel="stylesheet" href="./static/style/header.css" />
    <link rel="stylesheet" href="./static/style/admin_index.css" />
    <!-- Estilo específico para admin_index -->
    <title>Administrador del Sistema</title>
  </head>

  <body>
    <!-- Header -->
    <header id="">
      <div
        class="bg-warning d-flex justify-content-around p-3 align items-center"
      >
        <h1>
          <a href="/admin_index.html">
            <img
              src="./static/image/logo-sist.clinico.png"
              alt="logo-company"
              class="logo-company"
            />
          </a>
        </h1>
        <div class="mt-2">
          <!-- Enlaces de navegación -->
          <a class="menu-item" href="/configuracion_sistema.html"
            >Administración del sistema</a
          >
          <a class="menu-item" href="/administrador_usuarios.html"
            >Administración de usuarios</a
          >
          <a class="menu-item" href="/administrador_citas.html"
            >Administración de citas</a
          >
          <a class="menu-item" href="/reportes.html">Reportes</a>
        </div>
      </div>
    </header>
    <a href="admin_index.html" class="btn btn-outline-primary mt-3 ml-3">Regresar</a>
    <main class="container mt-5">
      <h1 class="my-5">Configuración del Sistema</h1>

      <div class=" card p-4 shadow shadow-lg my-5">
        <form id="configuracionForm">
          <!-- Imagen de fondo -->
          <div class="mb-3">
            <label for="imagenFondo" class="form-label">Imagen de Fondo</label>
            <input
              type="file"
              class="form-control"
              id="imagenFondo"
              name="imagenFondo"
            />
          </div>

          <!-- Descripción de la página -->
          <div class="mb-3">
            <label for="descripcionPagina" class="form-label"
              >Descripción de la Página</label
            >
            <textarea
              class="form-control"
              id="descripcionPagina"
              name="descripcionPagina"
              rows="3"
              required
            ></textarea>
          </div>

          <!-- Teléfonos de contacto -->
          <div class="mb-3">
            <label for="telefonosContacto" class="form-label"
              >Teléfonos de Contacto</label
            >
            <input
              type="text"
              class="form-control"
              id="telefonosContacto"
              name="telefonosContacto"
              required
            />
          </div>

          <!-- Dirección en el mapa -->
          <div class="mb-3">
            <label for="direccionMapa" class="form-label"
              >Dirección en el Mapa</label
            >
            <input
              type="text"
              class="form-control"
              id="direccionMapa"
              name="direccionMapa"
              required
            />
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">
              Guardar Configuración
            </button>
          </div>
        </form>
      </div>

      <!-- Mapa -->
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d31918.364855883414!2d-78.48591359999999!3d-0.19333119999999998!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses-419!2sec!4v1719726920800!5m2!1ses-419!2sec"
        width="100%"
        height="450"
        style="border: 0"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
      ></iframe>
    </main>
    <footer>
      <!-- place footer here -->
    </footer>
    <!-- Bootstrap JavaScript Libraries -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"
    ></script>

    <!-- Google Maps JavaScript API -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=TU_API_KEY&callback=initMap"
      async
      defer
    ></script>

    <!-- Lógica del Cliente -->
    <script>
      document
        .getElementById("configuracionForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // Obtener los valores del formulario
          const imagenFondo = document.getElementById("imagenFondo").files[0];
          const descripcionPagina =
            document.getElementById("descripcionPagina").value;
          const telefonosContacto =
            document.getElementById("telefonosContacto").value;
          const direccionMapa = document.getElementById("direccionMapa").value;

          // Simulación de almacenamiento de configuración
          const configuracion = {
            imagenFondo: imagenFondo ? URL.createObjectURL(imagenFondo) : null,
            descripcionPagina: descripcionPagina,
            telefonosContacto: telefonosContacto,
            direccionMapa: direccionMapa,
          };

          localStorage.setItem("configuracion", JSON.stringify(configuracion));

          // Mostrar configuración guardada
          alert("Configuración guardada correctamente");

          // Cargar imagen de fondo
          if (configuracion.imagenFondo) {
            document.body.style.backgroundImage = `url(${configuracion.imagenFondo})`;
          }

          // Cargar dirección en el mapa
          geocodeAddress(configuracion.direccionMapa);
        });

      function geocodeAddress(address) {
        const geocoder = new google.maps.Geocoder();
        geocoder.geocode({ address: address }, function (results, status) {
          if (status === "OK") {
            const map = new google.maps.Map(document.getElementById("mapa"), {
              zoom: 15,
              center: results[0].geometry.location,
            });
            new google.maps.Marker({
              map: map,
              position: results[0].geometry.location,
            });
          } else {
            alert("Geocode no tuvo éxito debido a: " + status);
          }
        });
      }

      function initMap() {
        // Inicializar el mapa con una ubicación predeterminada
        const map = new google.maps.Map(document.getElementById("mapa"), {
          zoom: 8,
          center: { lat: -34.397, lng: 150.644 },
        });
      }

      // Cargar configuración almacenada al iniciar
      window.onload = function () {
        const configuracion = JSON.parse(localStorage.getItem("configuracion"));
        if (configuracion) {
          if (configuracion.imagenFondo) {
            document.body.style.backgroundImage = `url(${configuracion.imagenFondo})`;
          }
          document.getElementById("descripcionPagina").value =
            configuracion.descripcionPagina;
          document.getElementById("telefonosContacto").value =
            configuracion.telefonosContacto;
          document.getElementById("direccionMapa").value =
            configuracion.direccionMapa;
          geocodeAddress(configuracion.direccionMapa);
        }
      };
    </script>
  </body>
</html>
